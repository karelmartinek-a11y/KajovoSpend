diff --git a/src/kajovospend/extract/parser.py b/src/kajovospend/extract/parser.py
index 9a7c6f4..1d2b7aa 100644
--- a/src/kajovospend/extract/parser.py
+++ b/src/kajovospend/extract/parser.py
@@ -1,7 +1,7 @@
 from __future__ import annotations
 
 import re
 import datetime as dt
 from dataclasses import dataclass
-from typing import List, Optional, Tuple, Dict, Iterable
+from typing import List, Optional, Tuple, Dict, Iterable, Sequence
 
 from dateutil import parser as dtparser
 
@@ -38,6 +38,142 @@ _STOP_ITEMS_RE = re.compile(
     re.IGNORECASE,
 )
 
+def _lines(text: str) -> List[str]:
+    return [ln.replace("\xa0", " ").rstrip("\r") for ln in (text or "").splitlines()]
+
+
+def _find_value_after_label_lines(
+    text: str,
+    labels: Sequence[str],
+    value_re: re.Pattern,
+    *,
+    max_lookahead_lines: int = 2,
+    section_hint_re: re.Pattern | None = None,
+) -> Optional[str]:
+    """
+    Robustní extrakce hodnoty, která bývá:
+      - na stejném řádku za label (IČO: 12345678)
+      - na dalším řádku (IČO:\n12345678)
+      - nebo label je nalepený na číslo / číslo je nalepené na label (26065801IČ:)
+
+    Pokud je section_hint_re zadán, prohledá nejdřív danou sekci (např. Dodavatel ... Odběratel),
+    a teprve pak celý text.
+    """
+    raw = text or ""
+    blocks: List[str] = []
+    if section_hint_re is not None:
+        m = section_hint_re.search(raw)
+        if m:
+            blocks.append(raw[m.start():m.end()])
+    blocks.append(raw)
+
+    for block in blocks:
+        ls = _lines(block)
+        for i, ln in enumerate(ls):
+            low = ln.lower()
+            if not any(lbl.lower() in low for lbl in labels):
+                continue
+            # 1) stejný řádek: zkus najít hodnotu přímo v řádku
+            m = value_re.search(ln)
+            if m:
+                return m.group(1).strip()
+            # 2) zbytek řádku za label
+            for lbl in labels:
+                j = low.find(lbl.lower())
+                if j != -1:
+                    tail = ln[j + len(lbl):]
+                    m2 = value_re.search(tail)
+                    if m2:
+                        return m2.group(1).strip()
+            # 3) další řádky
+            for k in range(1, max_lookahead_lines + 1):
+                if i + k >= len(ls):
+                    break
+                nxt = ls[i + k].strip()
+                if not nxt:
+                    continue
+                m3 = value_re.search(nxt)
+                if m3:
+                    return m3.group(1).strip()
+    return None
+
+
+def _extract_supplier_ico(text: str) -> Optional[str]:
+    """
+    Robustní IČO dodavatele:
+    - preferuj sekci "Dodavatel ... Odběratel" (pomáhá u faktur, kde je IČO dodavatele i odběratele)
+    - umí label na dalším řádku i "nalepené" vzory (12345678IČ:)
+    """
+    t = text or ""
+    section_re = re.compile(r"(?is)Dodavatel.*?(?:Odběratel|ODBĚRATEL|Odběratel:|ODBĚRATEL:)", re.IGNORECASE)
+
+    # 1) explicitní label (same-line / next-line)
+    raw = _find_value_after_label_lines(
+        t,
+        labels=("IČO", "ICO", "IČ"),
+        value_re=re.compile(r"(?i)(?:IČO|ICO|IČ)\s*[:#]?\s*(\d{8})\b"),
+        max_lookahead_lines=2,
+        section_hint_re=section_re,
+    )
+    if raw:
+        return _normalize_ico_soft(raw)
+
+    # 2) nalepené "12345678IČ:" / "12345678IČO:" (typicky SIKO PDF)
+    m = re.search(r"(?i)\b(\d{8})\s*(?:IČO|ICO|IČ)\s*[:#]\s*", t)
+    if m:
+        return _normalize_ico_soft(m.group(1))
+
+    # 3) fallback: první 8místné číslo v sekci Dodavatel (už bez labelu)
+    raw2 = _find_value_after_label_lines(
+        t,
+        labels=("Dodavatel",),
+        value_re=re.compile(r"(\d{8})"),
+        max_lookahead_lines=6,
+        section_hint_re=section_re,
+    )
+    return _normalize_ico_soft(raw2) if raw2 else None
+
+
+def _extract_doc_number(text: str) -> Optional[str]:
+    t = text or ""
+    doc_no = _find_first([
+        # explicitní daňový doklad / faktura
+        re.compile(r"DAŇOVÝ\s+DOKLAD\s+č\.?\s*([A-Z0-9][A-Z0-9/-]{2,})\b", re.IGNORECASE),
+        re.compile(r"DAŇOVÝ\s+DOKLAD\s*[-–]\s*(\d{4,})\b", re.IGNORECASE),
+        re.compile(r"Č[ií]slo\s+faktury\s*[: ]\s*([A-Z0-9][\w/-]{2,})", re.IGNORECASE),
+        re.compile(r"Faktura\s+č[ií]slo\s*[: ]\s*([A-Z0-9][\w/-]{2,})", re.IGNORECASE),
+        re.compile(r"Faktura\s*-?\s*daňový\s+doklad\s+č\.?\s*([\w/-]+)", re.IGNORECASE),
+
+        # Money S3: "variabilní:\n24202896"
+        re.compile(r"\bvariabiln[ií]\s*:\s*\n?\s*(\d{3,})\b", re.IGNORECASE),
+
+        # účtenky
+        re.compile(r"Ú?čtenka\s+č[ií]slo\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
+        re.compile(r"Doklad\s+č[ií]slo\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
+
+        # VS
+        re.compile(r"\bVS\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
+        re.compile(r"\bV\.?\s*S\.?\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
+        re.compile(r"\bV\s+S\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
+
+        # SIKO: "2011001146č.Daňový doklad - FAKTURA"
+        re.compile(r"\b(\d{6,})\s*č\.?\s*Daňov", re.IGNORECASE),
+        re.compile(r"\b(\d{6,})č\.\s*Daňov", re.IGNORECASE),
+    ], t)
+    if doc_no:
+        return doc_no.strip()
+
+    # DZV-996/2024 apod. – často v horní části
+    top = "\n".join(_lines(t)[:40])
+    m = re.search(r"\b([A-Z]{1,6}-\d{2,}(?:/\d{2,4})?)\b", top)
+    if m:
+        return m.group(1).strip()
+
+    # fallback: samostatné číslo 6-12 znaků v horní části
+    for ln in _lines(top):
+        s = (ln or "").strip()
+        if re.fullmatch(r"\d{6,12}", s):
+            return s
+    return None
+
 
 def _extract_rounding_items(text: str) -> List[dict]:
     items: List[dict] = []
     if not text:
@@ -315,22 +451,10 @@ def extract_from_text(text: str) -> Extracted:
     raw = text or ""
     t = raw
 
-    # IČO: dříve se bralo libovolné 8-číslí => často sebralo VS/číslo dokladu.
-    # Teď vyžadujeme kontext (IČO/ICO/IČ) a normalizujeme.
-    ico = _find_first(
-        [
-            re.compile(r"\bIČO\s*[: ]\s*([0-9][0-9\s-]{6,}[0-9])\b", re.IGNORECASE),
-            re.compile(r"\bICO\s*[: ]\s*([0-9][0-9\s-]{6,}[0-9])\b", re.IGNORECASE),
-            re.compile(r"\bIČ\s*[: ]\s*([0-9][0-9\s-]{6,}[0-9])\b", re.IGNORECASE),
-        ],
-        t,
-    )
-    ico = _normalize_ico_soft(ico)
-
-    doc_no = _find_first([
-        re.compile(r"Č[ií]slo\s+faktury\s*[: ]\s*([\w-]+)", re.IGNORECASE),
-        re.compile(r"Faktura\s+č[ií]slo\s*[: ]\s*([\w-]+)", re.IGNORECASE),
-        re.compile(r"Faktura\s*#\s*(\d+)", re.IGNORECASE),
-        re.compile(r"Č[ií]slo\s+objednávky\s*[: ]\s*([\w-]+)", re.IGNORECASE),
-        # Daňové doklady často mají číslo hned pod nadpisem bez "č."
-        re.compile(r"DAŇOVÝ\s+DOKLAD\s*(?:č\.?\s*)?\n?\s*([A-Z0-9][A-Z0-9-]{2,})\b", re.IGNORECASE),
-        re.compile(r"Faktura\s*-?\s*daňový\s+doklad\s+č\.?\s*([\w-]+)", re.IGNORECASE),
-        # Účtenky
-        re.compile(r"Ú?čtenka\s+č[ií]slo\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
-        re.compile(r"Doklad\s+č[ií]slo\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
-        # Variabilní symbol (u faktur často funguje jako stabilní identifikátor)
-        re.compile(r"\bVS\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),
-        re.compile(r"\bV\.?\s*S\.?\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),   # V.S.
-        re.compile(r"\bV\s+S\s*[: ]\s*(\d{3,})\b", re.IGNORECASE),         # V S
-    ], t)
+    # IČO a číslo dokladu robustněji (same-line/next-line/glued)
+    ico = _extract_supplier_ico(t)
+    doc_no = _extract_doc_number(t)
 
     bank_account = _find_first([
         re.compile(r"\bIBAN\s*[: ]\s*([A-Z]{2}\d{2}[A-Z0-9]{10,})\b"),
         re.compile(r"\bÚčet\s*[: ]\s*(\d{6,}-?\d{2,}/\d{4})\b", re.IGNORECASE),
         re.compile(r"\b(\d{6,}-?\d{2,})\s*/\s*(\d{4})\b"),
     ], t)
